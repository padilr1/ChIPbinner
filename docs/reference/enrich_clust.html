<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Enrichment &amp; depletion analysis for clusters of bins. — enrich_clust • ChIPbinner</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Enrichment &amp; depletion analysis for clusters of bins. — enrich_clust"><meta property="og:description" content="Performs overlap enrichment &amp;amp; depletion analysis between bins found in a specific cluster and a class of annotated regions from a curated database. Uses Fisher's exact test to assess statistical significance of the overlap against a background of all bins found in both cell lines being compared."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ChIPbinner</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/ChIPbinner_workflow.html">Analyzing binned ChIP-seq/Cut&amp;Run data with ChIPbinner</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Enrichment &amp; depletion analysis for clusters of bins.</h1>
    
    <div class="hidden name"><code>enrich_clust.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs overlap enrichment &amp; depletion analysis between bins found in a specific cluster and a class of annotated regions from a curated database. Uses Fisher's exact test to assess statistical significance of the overlap against a background of all bins found in both cell lines being compared.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">enrich_clust</span><span class="op">(</span></span>
<span>  <span class="va">genome_assembly</span>,</span>
<span>  <span class="va">annotated_clusters</span>,</span>
<span>  <span class="va">query_cluster</span>,</span>
<span>  <span class="va">pooled_bed_file</span>,</span>
<span>  <span class="va">functional_db</span>,</span>
<span>  <span class="va">region</span>,</span>
<span>  <span class="va">cores</span>,</span>
<span>  <span class="va">n_elements</span>,</span>
<span>  <span class="va">cutoff_for_overlap</span>,</span>
<span>  <span class="va">file_plot_name</span>,</span>
<span>  <span class="va">output_table_name</span>,</span>
<span>  <span class="va">width_of_plot</span>,</span>
<span>  <span class="va">height_of_plot</span>,</span>
<span>  <span class="va">out_dir</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>genome_assembly</dt>
<dd><p>A character string specifying the genome assembly. Allowed values include "hg38" or "mm10".</p></dd>


<dt>annotated_clusters</dt>
<dd><p>An R object containing annotated clusters, generated from the annotate_clust() function.</p></dd>


<dt>query_cluster</dt>
<dd><p>A character string specifying the cluster being to be tested. Normally, the clusters are label alphabetically from A to Z. For example, "B" to specify cluster B.</p></dd>


<dt>pooled_bed_file</dt>
<dd><p>A BED file generated from 'pre_clus()' consisting of pooled genomic coordinates found in both samples being compared. Used for the background.</p></dd>


<dt>functional_db</dt>
<dd><p>An R object consisting of a curated database of functional annotations.</p></dd>


<dt>region</dt>
<dd><p>A string specifying the region to be tested. Must be one of "genome_wide", "genic" or "intergenic". Genome_wide indicates global testing of bins, including those found in both intergenic and genic regions. By specifying the region to be either genic or intergenic, the user can evaluate exclusively genic or intergenic bins overlapping a specific class of annotated regions. In these cases, the background is stratified to only genic or intergenic regions to avoid spurious associations to annotations confounded by their predominantly genic or intergenic localization.</p></dd>


<dt>cores</dt>
<dd><p>An integer specifying the number of parallel cores to be used.</p></dd>


<dt>n_elements</dt>
<dd><p>An integer specifying the number of elements to be plotted. This will not affect the output table.</p></dd>


<dt>cutoff_for_overlap</dt>
<dd><p>An integer specifying the minimum number of overlap between the bins in the specified cluster and the class of annotated regions.</p></dd>


<dt>file_plot_name</dt>
<dd><p>A character string specifying the filename of the output plot.</p></dd>


<dt>output_table_name</dt>
<dd><p>A character string specifying the filename for the output table.</p></dd>


<dt>width_of_plot</dt>
<dd><p>A numeric specifying the width of the plot.</p></dd>


<dt>height_of_plot</dt>
<dd><p>A numeric specifying the height of the plot.</p></dd>


<dt>out_dir</dt>
<dd><p>A character string specifying the output directory.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A table and plot of the results of the enrichment &amp; depletion analysis.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Title</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#!/usr/bin/env Rscript</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rtracklayer</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/GenomicRanges" class="external-link">GenomicRanges</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://code.databio.org/LOLA" class="external-link">LOLA</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jkunst.com/highcharter/" class="external-link">highcharter</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Registered S3 method overwritten by 'quantmod':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   method            from</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   as.zoo.data.frame zoo </span>
<span class="r-in"><span><span class="fu">enrich_clust</span><span class="op">(</span></span></span>
<span class="r-in"><span>  genome_assembly <span class="op">=</span> <span class="st">"hg38"</span>,</span></span>
<span class="r-in"><span>  annotated_clusters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/data"</span>,<span class="st">"downsampled_annotated_clusters.rda"</span>, package <span class="op">=</span> <span class="st">"ChIPbinner"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  query_cluster <span class="op">=</span> <span class="st">"B"</span>,</span></span>
<span class="r-in"><span>  pooled_bed_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"downsampled.Cal27.WT.NSD1_KO.H3K36me2.10kb_pooled.bed.gz"</span>, package <span class="op">=</span> <span class="st">"ChIPbinner"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  functional_db <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/data"</span>,<span class="st">"downsampled_hg38_ccreDB.rda"</span>, package <span class="op">=</span> <span class="st">"ChIPbinner"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  region <span class="op">=</span> <span class="st">"genome_wide"</span>,</span></span>
<span class="r-in"><span>  cores <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  n_elements <span class="op">=</span> <span class="fl">7</span>,</span></span>
<span class="r-in"><span>  cutoff_for_overlap <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  file_plot_name <span class="op">=</span> <span class="st">"downsampled.ccre.genome_wide.enrichment_depletion"</span>,</span></span>
<span class="r-in"><span>  output_table_name <span class="op">=</span> <span class="st">"downsampled.ccre.genome_wide.enrichment_depletion"</span>,</span></span>
<span class="r-in"><span>  width_of_plot <span class="op">=</span> <span class="fl">7</span>,</span></span>
<span class="r-in"><span>  height_of_plot <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  out_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"ChIPbinner"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converting GRanges to GRangesList.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating unit set overlaps...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating universe set overlaps...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating Fisher scores...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converting GRanges to GRangesList.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating unit set overlaps...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating universe set overlaps...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating Fisher scores...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for <span style="color: #00BB00;">size</span> is already present.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding another scale for <span style="color: #00BB00;">size</span>, which will replace the existing scale.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Depletion output successfully generated! No significant enrichment found."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Enrichment/depletion analysis finished!"</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Reinnier Padilla.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

