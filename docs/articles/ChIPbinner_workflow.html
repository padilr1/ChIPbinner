<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analyzing binned ChIP-seq/Cut&amp;Run data with ChIPbinner • ChIPbinner</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing binned ChIP-seq/Cut&amp;Run data with ChIPbinner">
<meta property="og:description" content="ChIPbinner">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ChIPbinner</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ChIPbinner_workflow.html">Analyzing binned ChIP-seq/Cut&amp;Run data with ChIPbinner</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analyzing binned ChIP-seq/Cut&amp;Run data with
ChIPbinner</h1>
            
      
      
      <div class="hidden name"><code>ChIPbinner_workflow.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ChIPbinner</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="database-for-chipbinner">Database for ChIPbinner<a class="anchor" aria-label="anchor" href="#database-for-chipbinner"></a>
</h2>
<p>Only toy datasets, which have been largely downsampled, are included
with the package. For complete example datasets please see
<a href="https://github.com/padilr1/ChIPbinner_database.git" class="external-link">ChIPbinner
database</a>.</p>
</div>
<div class="section level2">
<h2 id="example-workflow-for-generating-binned-bed-files">Example workflow for generating binned BED files<a class="anchor" aria-label="anchor" href="#example-workflow-for-generating-binned-bed-files"></a>
</h2>
<p>For input into ChIPbinner, the sequenced samples will need to be
binned into windows, and formatted as a
<a href="https://genome.ucsc.edu/FAQ/FAQformat" class="external-link">BED</a> file. One of the
tools that can be used to perform this task is
<a href="https://bedtools.readthedocs.io/en/latest/" class="external-link">BEDtools</a>, which
can convert an aligned sequence file, typically found in a
<a href="https://genome.ucsc.edu/goldenPath/help/bam.html" class="external-link">BAM</a>
format, into a binned BED file as demonstrated below.</p>
<p>Reference windows ($WINDOW_REF) can be found in the
<a href="https://github.com/padilr1/ChIPbinner_database.git" class="external-link">ChIPbinner
database</a>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># convert aligned BAM file to BED file</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="ex">bedtools</span> bamtobed <span class="at">-i</span> <span class="va">${sample}</span>.sorted.bam <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-k1,1</span> <span class="at">-k2,2n</span> <span class="op">&gt;</span> <span class="va">${sample}</span>.bed</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co"># intersect sample BED file with binned reference files</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="ex">bedtools</span> intersect <span class="at">-a</span> <span class="va">$WINDOW_REF</span> <span class="at">-b</span> <span class="va">${sample}</span>.bed <span class="at">-sorted</span> <span class="at">-c</span> <span class="at">-nonamecheck</span> <span class="op">&gt;</span> <span class="va">$OUTPUT_NAME</span>.binned.bed</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># example for binning Cal27 WT sample into 10kb windows</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="ex">bedtools</span> bamtobed <span class="at">-i</span> Cal27.WT.H3K36me2.sorted.bam <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-k1,1</span> <span class="at">-k2,2n</span> <span class="op">&gt;</span> Cal27.WT.H3K36me2.bed</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="ex">bedtools</span> intersect <span class="at">-a</span> hg38.10kb.windows.bed <span class="at">-b</span> Cal27.WT.H3K36me2.bed <span class="at">-sorted</span> <span class="at">-c</span> <span class="at">-nonamecheck</span> <span class="op">&gt;</span> Cal27.WT.H3K36me2.10kb.bed</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="generating-normalized-bigwig-files">Generating normalized bigwig files<a class="anchor" aria-label="anchor" href="#generating-normalized-bigwig-files"></a>
</h2>
<p>When you bin your files into windows, especially from aligned (BAM or
SAM) files, they are typically raw read counts. They will need to be
normalized by the input (highly recommended for ChIP-seq data) and
likely scaled by some factor (we recommend using a normalization scaling
factor like genome-wide modification percentage information obtained
from mass spectrometry, Drosophila spike-in or any other types of
spike-in). This step will have to be performed prior to moving on to the
rest of the workflow.</p>
<p>Here, we are generating normalized bigwig files for 10kb-binned files
(in BED format) for a head and neck squamous cell carcinoma (HNSCC) line
(Cal27) for the broad histone mark H3K36me2 generated via ChIP-seq. The
lysine 36 methyl transferase NSD1 was knocked out in the sample
(NSD1-KO) and is being compared to the wildtype (WT) cell line. Please
see
<a href="https://www.sciencedirect.com/science/article/pii/S2211124721000826?via%3Dihub" class="external-link">Farhangdoost
et al. 2021</a> for more details.</p>
<p><b>Important note:</b> For ChIPbinner, only two genome assemblies can
be used: <code>hg38</code> or <code>mm10</code>. We will be using the
<code>hg38</code> assembly for this analysis.</p>
<p>If you’ve ran the code chunk successfully, your resulting bigwig
files will be found in the <code>output_directory</code> that you
specified when running the function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate normalized bigwig for WT sample</span></span>
<span><span class="fu"><a href="../reference/norm_bw.html">norm_bw</a></span><span class="op">(</span>out_dir <span class="op">=</span> <span class="st">"output_directory"</span>, genome_assembly <span class="op">=</span> <span class="st">"hg38"</span>,</span>
<span>    chip_samp_binned_file <span class="op">=</span> <span class="st">"Cal27.WT.H3K36me2.10kb.bed"</span>, chip_samp_library_size <span class="op">=</span> <span class="fl">64093770</span>,</span>
<span>    use_control <span class="op">=</span> <span class="cn">TRUE</span>, control_binned_file <span class="op">=</span> <span class="st">"Cal27.WT_input.H3K36me2.10kb.bed"</span>,</span>
<span>    control_library_size <span class="op">=</span> <span class="fl">52047022</span>, raw_count_cutoff <span class="op">=</span> <span class="fl">0</span>, pseudocount <span class="op">=</span> <span class="fl">1e-15</span>,</span>
<span>    scaling_factor <span class="op">=</span> <span class="fl">0.450328805</span><span class="op">)</span></span>
<span><span class="co"># generate normalized bigwig for NSD1-KO sample</span></span>
<span><span class="fu"><a href="../reference/norm_bw.html">norm_bw</a></span><span class="op">(</span>out_dir <span class="op">=</span> <span class="st">"output_directory"</span>, genome_assembly <span class="op">=</span> <span class="st">"hg38"</span>,</span>
<span>    chip_samp_binned_file <span class="op">=</span> <span class="st">"Cal27.NSD1_KO.H3K36me2.10kb.bed"</span>,</span>
<span>    chip_samp_library_size <span class="op">=</span> <span class="fl">18598272</span>, use_control <span class="op">=</span> <span class="cn">TRUE</span>, control_binned_file <span class="op">=</span> <span class="st">"Cal27.NSD1_KO_input.H3K36me2.10kb.bed"</span>,</span>
<span>    control_library_size <span class="op">=</span> <span class="fl">18674189</span>, raw_count_cutoff <span class="op">=</span> <span class="fl">0</span>, pseudocount <span class="op">=</span> <span class="fl">1e-15</span>,</span>
<span>    scaling_factor <span class="op">=</span> <span class="fl">0.192272095</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="generating-scatterplots-with-bins-stratified-into-genic-and-intergenic-regions">Generating scatterplots with bins stratified into genic and
intergenic regions<a class="anchor" aria-label="anchor" href="#generating-scatterplots-with-bins-stratified-into-genic-and-intergenic-regions"></a>
</h2>
<p>After normalizing and converting the binned BED files into bigwigs,
we can read them in and generate a scatterplot comparing two cell lines.
The scatterplot will annotate genic and intergenic regions accordingly.
The resulting figures will be found in <code>/output_directory</code>
for the code chunk below.</p>
<p>Genic and intergenic regions for <code>hg38</code> and
<code>mm10</code> are included with the package and can be accessed as
indicated in the code chunk below. <b> Note: you will need to adjust the
minimum and maximum values for the x- and y-axis accordingly.</b>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/genic_intergenic_scatterplot.html">genic_intergenic_scatterplot</a></span><span class="op">(</span>out_dir <span class="op">=</span> <span class="st">"output_directory"</span>, genome_assembly <span class="op">=</span> <span class="st">"hg38"</span>,</span>
<span>    cell_line <span class="op">=</span> <span class="st">"Cal27"</span>, wildtype_samp_norm_bw <span class="op">=</span> <span class="st">"Cal27.WT.H3K36me2.10kb.norm.bw"</span>,</span>
<span>    treated_samp_norm_bw <span class="op">=</span> <span class="st">"Cal27.NSD1_KO.H3K36me2.10kb.norm.bw"</span>,</span>
<span>    are_R_objects <span class="op">=</span> <span class="cn">FALSE</span>, histone_mark <span class="op">=</span> <span class="st">"H3K36me2"</span>, output_filename <span class="op">=</span> <span class="st">"Cal27.WT_NSD1KO.H3K36me2.10kb"</span>,</span>
<span>    title_of_plot <span class="op">=</span> <span class="st">"Cal27 ChIP-seq H3K36me2"</span>, xaxis_label <span class="op">=</span> <span class="st">"WT"</span>,</span>
<span>    yaxis_label <span class="op">=</span> <span class="st">"NSD1_KO"</span>, max_x <span class="op">=</span> <span class="fl">1</span>, max_y <span class="op">=</span> <span class="fl">1</span>, min_x <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>,</span>
<span>    min_y <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, pow <span class="op">=</span> <span class="fl">1.25</span>, show_scales <span class="op">=</span> <span class="cn">FALSE</span>, show_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    legend_pos <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="generating-clusters-of-similarly-behaving-genomic-bins">Generating clusters of similarly-behaving genomic bins<a class="anchor" aria-label="anchor" href="#generating-clusters-of-similarly-behaving-genomic-bins"></a>
</h2>
<div class="section level3">
<h3 id="processing-bigwig-files-for-clustering">Processing bigwig files for clustering<a class="anchor" aria-label="anchor" href="#processing-bigwig-files-for-clustering"></a>
</h3>
<p>Prior to generating clusters, we need to pre-process the normalized
bigWig files, which entails finding overlapping regions between two
bigWig files, removing the bottom and top 1% of bins across the two
samples (trimming to make the graphics more visible) and finally
generating a matrix of scores as well as a BED file of coordinates to be
used with HDBScan for generating clusters of similarly-behaving bins.
This is accomplished using the <code>pre_clus()</code> function. We will
continue to use the samples from the previous steps above.</p>
<p><b>Important note: Normally, bigWig files are used as input
throughout the workflow. However, R objects of the bigWig files can also
be used, but must specified by setting
<code>are_R_objects=TRUE</code></b>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pre_clust.html">pre_clust</a></span><span class="op">(</span></span>
<span>  out_dir <span class="op">=</span> <span class="st">"output_directory"</span>,</span>
<span>  treated_samp_norm_bw <span class="op">=</span> <span class="st">"Cal27.WT.H3K36me2.10kb.norm.bw"</span>,</span>
<span>  wildtype_samp_norm_bw <span class="op">=</span> <span class="st">"Cal27.NSD1_KO.H3K36me2.10kb.norm.bw"</span>,</span>
<span>  output_filename <span class="op">=</span> <span class="st">"Cal27.WT.NSD1_KO.H3K36me2.10kb"</span>,</span>
<span>  are_R_objects <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="running-hdbscan-to-generate-clusters">Running HDBSCAN to generate clusters<a class="anchor" aria-label="anchor" href="#running-hdbscan-to-generate-clusters"></a>
</h3>
<p>The <code>clus()</code> function can be used to generate clusters of
similarly-behaving genomic bins. It is based on an unsupervised learning
algorithm to find clusters, or dense regions, of a dataset. More details
on the Hierarchical Density-Based Spatial Clustering of Applications
with Noise (HDBSCAN) algorithm can be found
<a href="https://hdbscan.readthedocs.io/en/latest/index.html" class="external-link">here</a>.
The function uses <code>reticulate</code> as an interface to a Python
session. <b>Python version 3.9 will need to be installed in your
environment prior to running the function.</b> No other actions are
required from the user, as the minimal Python packages are automatically
installed in an isolated virtual environment specifically designated for
the ChIPbinner R package. This minimizes the risk of inadvertently
disrupting another Python installation on the user’s system.</p>
<p><b>It is important to consider this step will require substantial
processing memory as well as time </b>. Thus, it is recommended that you
use the python-implementation of HDBSCAN in a High-performance Computing
server instead. Nevertheless, an example workflow for running HDBSCAN is
found below. Here, we use the complete matrix file, which required
substantial processing memory and multiple parallel cores, typically
found in a high-performance computing cluster. The complete matrix file
can be found at the
<a href="https://github.com/padilr1/ChIPbinner_database.git" class="external-link">ChIPbinner
database</a>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># using the complete matrix</span></span>
<span><span class="fu"><a href="../reference/generate_clust.html">generate_clust</a></span><span class="op">(</span></span>
<span>  output_file_name <span class="op">=</span> <span class="st">"Cal27.WT.NSD1_KO.H3K36me2.10kb"</span>,</span>
<span>  out_dir <span class="op">=</span> <span class="st">"output_directory"</span>,</span>
<span>  matrix_file <span class="op">=</span> <span class="st">"Cal27.WT.NSD1_KO.H3K36me2.10kb.mat.csv"</span>,</span>
<span>  minpts <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  minsamps <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">6</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="annotating-clusters">Annotating clusters<a class="anchor" aria-label="anchor" href="#annotating-clusters"></a>
</h3>
<p>After identifying clusters using HDBSCAN, these clusters need to be
annotated for use in downstream analysis.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/annotate_clust.html">annotate_clust</a></span><span class="op">(</span>number_of_clusters <span class="op">=</span> <span class="fl">3</span>,</span>
<span>               matrix_file <span class="op">=</span> <span class="st">"Cal27.WT.NSD1_KO.H3K36me2.10kb_mat.csv"</span>,</span>
<span>               pooled_bed_file <span class="op">=</span> <span class="st">"Cal27.WT.NSD1_KO.H3K36me2.10kb_pooled.bed"</span>,</span>
<span>               hdbscan_output_file <span class="op">=</span> <span class="st">"clus.Cal27.WT.NSD1_KO.H3K36me2.10kb.5000.5000.txt"</span>,</span>
<span>               output_filename <span class="op">=</span> <span class="st">"Cal27.WT.NSD1_KO.H3K36me2.10kb"</span>,</span>
<span>               out_dir<span class="op">=</span><span class="st">"output_directory"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="generating-density-based-scatterplots">Generating density-based scatterplots<a class="anchor" aria-label="anchor" href="#generating-density-based-scatterplots"></a>
</h3>
<p>Finally, a density-based cluster scatterplot (along with the
genic/intergenic scatterplot) can be generated using
<code><a href="../reference/density_based_scatterplot.html">density_based_scatterplot()</a></code>. Here, we used the complete
matrix of enrichment scores to generate the HBDSCAN output. The complete
HDBSCAN output can found at
<a href="https://github.com/padilr1/ChIPbinner_database.git" class="external-link">ChIPbinner
database</a>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/density_based_scatterplot.html">density_based_scatterplot</a></span><span class="op">(</span></span>
<span>  out_dir <span class="op">=</span> <span class="st">"output_directory"</span>,</span>
<span>  genome_assembly <span class="op">=</span> <span class="st">"hg38"</span>,</span>
<span>  are_R_objects <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  output_filename <span class="op">=</span> <span class="st">"Cal27.WT.NSD1_KO.H3K36me2.10kb"</span>,</span>
<span>  wildtype_samp_norm_bw <span class="op">=</span><span class="st">"Cal27_WT_H3K36me2_10kb.norm.bw"</span>,</span>
<span>  treated_samp_norm_bw <span class="op">=</span> <span class="st">"Cal27_NSD1_KO_H3K36me2_10kb.norm.bw"</span>,</span>
<span>  cell_line <span class="op">=</span> <span class="st">"Cal27"</span>,</span>
<span>  histone_mark <span class="op">=</span> <span class="st">"H3K36me2"</span>,</span>
<span>  annotated_clusters <span class="op">=</span><span class="st">"Cal27.WT.NSD1_KO.H3K36me2.10kb_annotated_clusters.rda"</span>,</span>
<span>  number_of_clusters <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  title_of_plot <span class="op">=</span> <span class="st">"H3K36me2"</span>,</span>
<span>  pow <span class="op">=</span> <span class="fl">1.1</span>,</span>
<span>  show_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  min <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  bin_size <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  show_scales <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  xaxis_label <span class="op">=</span> <span class="st">"WT"</span>,</span>
<span>  yaxis_label <span class="op">=</span> <span class="st">"NSD1_KO"</span>,</span>
<span>  height_of_figure <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  width_of_figure <span class="op">=</span> <span class="fl">15</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="overlap-enrichmentdepletion-analysis-with-annotated-clusters-of-bins">Overlap enrichment/depletion analysis with annotated clusters of
bins<a class="anchor" aria-label="anchor" href="#overlap-enrichmentdepletion-analysis-with-annotated-clusters-of-bins"></a>
</h2>
<p>After identifying and annotating clusters of bins, a Fisher’s exact
test can be used to determine whether these bins overlap a specific
class of annotated regions against a background of all bins. The
underlying algorithm is based on
<a href="https://bioconductor.org/packages/release/bioc/html/LOLA.html" class="external-link">LOLA
- locus overlap analysis for enrichment of genomic ranges</a>. The
example below evaluates overlap with
<a href="https://useast.ensembl.org/info/genome/index.html" class="external-link">Ensembl</a>
annotations genome-wide. However, the user can also evaluate overlap
with other functional annotations by inputting an R object of the
database of their choice in the parameter
<code>functional_db</code>.</p>
<p>The
<a href="https://github.com/padilr1/ChIPbinner_database.git" class="external-link">ChIPbinner
database</a> contains curated databases ready for input into the
parameter <code>functional_db</code> within the
<code><a href="../reference/enrich_clust.html">enrich_clust()</a></code> function.</p>
<p>Nevertheless, by specifying the <code>region</code> to be either
<code>genic</code> or <code>intergenic</code>, the user can evaluate
exclusively genic or intergenic bins overlapping a specific class of
annotated regions. In these cases, the background is stratified to only
genic or intergenic regions to avoid spurious associations to
annotations confounded by their predominantly genic or intergenic
localization.</p>
<p>Below is an example of how to calculate overlap enrichment &amp;
depletion result of Ensembl annotations with bins found in cluster B
identified from the previous analyses. Note that the size of the dots
corresponds to the number of bins overlapping the corresponding
annotation. The p-value is based on Fisher’s exact test of bins
overlapping a specific class of annotated regions versus a background of
all bins found in both cell lines being compared.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/enrich_clust.html">enrich_clust</a></span><span class="op">(</span></span>
<span>  genome_assembly <span class="op">=</span> <span class="st">"hg38"</span>,</span>
<span>  annotated_clusters <span class="op">=</span> <span class="st">"Cal27.WT.NSD1_KO.H3K36me2.10kb_annotated_clusters.rda"</span>,</span>
<span>  query_cluster <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>  pooled_bed_file <span class="op">=</span> <span class="st">"Cal27.WT.NSD1_KO.H3K36me2.10kb_pooled.bed"</span>,</span>
<span>  functional_db <span class="op">=</span> <span class="st">"hg38_ensemblDB.rda"</span>,</span>
<span>  region <span class="op">=</span> <span class="st">"genome_wide"</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  n_elements <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  cutoff_for_overlap <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  file_plot_name <span class="op">=</span> <span class="st">"ensembl.genome_wide.enrichment_depletion"</span>,</span>
<span>  output_table_name <span class="op">=</span> <span class="st">"ensembl.genome_wide.enrichment_depletion"</span>,</span>
<span>  width_of_plot <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  height_of_plot <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  out_dir <span class="op">=</span> <span class="st">"output_directory"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Reinnier Padilla.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
